<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lá»‹ch trÃ¬nh iu Ä‘Æ°Æ¡ng</title>
  <!-- Load modern-fancy fonts: Playfair Display for headings, Poppins for body -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      /* deeper starry night gradient as a fallback behind the canvas */
      background: radial-gradient(ellipse at 20% 10%, #0b1533 0%, transparent 40%),
                  linear-gradient(180deg, #071029 0%, #071833 60%, #0b2140 100%);
      font-family: 'Poppins', 'Segoe UI', system-ui, -apple-system, Roboto, 'Helvetica Neue', Arial, sans-serif;
      color: #fff;
    }

    h1 {
      margin-bottom: 10px;
      font-size: 2em;
      letter-spacing: 1px;
      font-family: 'Playfair Display', Georgia, 'Times New Roman', serif;
      font-weight: 600;
      letter-spacing: 0.6px;
      text-shadow: 0 0 10px rgba(255,255,255,0.14);
    }

    #calendar {
      background: rgba(255,255,255,0.06);
      border-radius: 20px;
      padding: 20px 30px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      backdrop-filter: blur(6px);
    }
    
    /* Starry night layers */
    .sky {
      position: fixed;
      inset: 0;
      pointer-events: none; /* allow clicks through to calendar */
      overflow: hidden;
      z-index: 0;
    }

    .stars, .stars2, .twinkle {
      position: absolute;
      inset: 0;
      background: transparent;
    }

    /* small subtle star field using box-shadow trick for performance */
    .stars::after, .stars2::after {
      content: '';
      position: absolute;
      inset: 0;
      background-image: radial-gradient(#ffffff 0.8px, rgba(255,255,255,0.0) 1px);
      background-repeat: repeat;
      opacity: 0.7;
      transform: scale(1);
    }

    .stars { opacity: 0.55; filter: blur(0.2px); transform: scale(1); }
    .stars2 { opacity: 0.35; transform: scale(1.6); filter: blur(0.6px); }

    /* twinkling layer animated with opacity changes */
    .twinkle::after {
      content: '';
      position: absolute;
      inset: 0;
      background-image: radial-gradient(circle at 10% 20%, rgba(255,255,255,0.9) 0px, rgba(255,255,255,0.0) 6px),
                        radial-gradient(circle at 70% 40%, rgba(255,255,255,0.8) 0px, rgba(255,255,255,0.0) 5px),
                        radial-gradient(circle at 40% 70%, rgba(255,255,255,0.7) 0px, rgba(255,255,255,0.0) 4px);
      background-repeat: no-repeat;
      opacity: 0.85;
      animation: twinkle 6s infinite linear;
      mix-blend-mode: screen;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.4; transform: translateY(0); }
      50% { opacity: 1; transform: translateY(-2px); }
    }

    /* Moon */
    .moon {
      position: absolute;
      right: 8%;
      top: 8%;
      width: 110px;
      height: 110px;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #f0f0f5 30%, #d9e6ff 60%, rgba(255,255,255,0) 100%);
      border-radius: 50%;
      box-shadow: 0 0 30px rgba(255,255,240,0.12), inset -6px -8px 18px rgba(0,0,0,0.12);
      filter: blur(0.2px);
      z-index: 1;
      opacity: 0.95;
    }

    /* shooting star element */
    .shooting {
      position: absolute;
      width: 2px;
      height: 80px;
      background: linear-gradient(180deg, rgba(255,255,255,0.0) 0%, rgba(255,255,255,0.95) 40%, rgba(255,255,255,0.0) 100%);
      transform: rotate(-30deg) translateX(-100vw);
      opacity: 0;
      z-index: 2;
      pointer-events: none;
    }

    @keyframes shoot {
      0% { opacity: 0; transform: translate3d(-10vw, -10vh, 0) rotate(-30deg) scaleY(1); }
      10% { opacity: 1; }
      100% { opacity: 0; transform: translate3d(110vw, 110vh, 0) rotate(-30deg) scaleY(0.6); }
    }

    table {
      border-collapse: collapse;
      width: 100%;
      text-align: center;
      color: #fff;
    }

    th {
      padding: 10px;
      font-weight: normal;
      opacity: 0.8;
    }

    td {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      position: relative;
    }

    td:hover {
      background: rgba(255,255,255,0.1);
    }

    /* Circle highlight for important days */
    .important {
      border: 2px solid #ffd369;
      color: #ffd369;
      font-weight: bold;
    }

    /* Tooltip for notes */
    .tooltip {
      visibility: hidden;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 6px 10px;
      position: absolute;
      z-index: 1;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.85em;
      white-space: nowrap;
    }

    td:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }

    /* Timer at bottom */
    #timer {
      margin-top: 25px;
      font-size: 1em;
      opacity: 0.9;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Our Love Calendar âœ¨</h1>
  <div id="calendar-controls" style="z-index:6; width:100%; max-width:700px; display:flex; justify-content:space-between; align-items:center; gap:12px; padding:0 20px; box-sizing:border-box;">
    <button id="prevMonth" aria-label="Previous month" style="background:transparent;border:0;color:#fff;font-size:1.2em;cursor:pointer;">â—€</button>
    <div id="monthTitle" style="flex:1;text-align:center;font-weight:600"></div>
    <button id="nextMonth" aria-label="Next month" style="background:transparent;border:0;color:#fff;font-size:1.2em;cursor:pointer;">â–¶</button>
  </div>
  <!-- sync controls removed (using localStorage only) -->
  <div id="calendar" style="z-index:5; width:100%; max-width:700px;"></div>
  <div id="timer"></div>

  <!-- Starry night layers -->
  <div class="sky" aria-hidden="true">
    <div class="stars"></div>
    <div class="stars2"></div>
    <div class="twinkle"></div>
    <div class="moon"></div>
    <div class="shooting" id="shooting"></div>
  </div>

  <!-- Notes modal -->
  <div id="noteModal" role="dialog" aria-modal="true" style="display:none;position:fixed;inset:0;align-items:center;justify-content:center;z-index:20;">
    <div style="background:rgba(6,10,20,0.9);padding:18px;border-radius:12px;color:#fff;max-width:420px;width:92%;box-shadow:0 8px 30px rgba(0,0,0,0.6);">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <strong id="noteDate" style="font-size:1.05em"></strong>
        <button id="closeModal" style="background:transparent;border:0;color:#fff;font-size:1.2em;cursor:pointer">âœ•</button>
      </div>
      <label style="display:block;font-size:0.9em;margin-bottom:6px;">Author</label>
      <div id="authorPills" style="display:flex;gap:8px;margin-bottom:8px;">
        <button type="button" data-author="em bÃ©" class="author-pill" style="padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,0.12);background:transparent;color:#fff;cursor:pointer">em bÃ©</button>
        <button type="button" data-author="anh bÃ©" class="author-pill" style="padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,0.12);background:transparent;color:#fff;cursor:pointer">anh bÃ©</button>
      </div>
      <input type="hidden" id="noteAuthor" />
      <label style="display:block;font-size:0.9em;margin-bottom:6px;">Memory / Note</label>
      <textarea id="noteText" rows="5" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);margin-bottom:8px;background:transparent;color:#fff;"></textarea>
      <div style="display:flex;gap:8px;justify-content:flex-end;">
        <button id="deleteNote" style="background:transparent;border:1px solid rgba(255,255,255,0.12);color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer">Delete</button>
        <button id="saveNote" style="background:#ffd369;border:0;padding:8px 14px;border-radius:8px;cursor:pointer;color:#2b1b00;font-weight:600">Save</button>
      </div>
    </div>
  </div>

  <script>
    // ðŸ’• Set your start date here
    const startDate = new Date("2025-08-04T21:00:00");

    // ðŸ’• List your important days here
    const importantDays = {
      "2025-06-01": "HÃ´m Ä‘áº§u embe thá»©c tá»›i 7h sÃ¡ng nÃ¬e ",
      "2025-06-02": "ChÃº chÃ¡u =))",
      "2025-07-14": "Láº§n Ä‘áº§u embe zÃ´ nháº­t kÃ½ cá»§a emm",
      "2025-07-31": "Gáº·p embe zá»›i ky láº§n Ä‘áº§u",
      "2025-08-04": "Em lÃ m everyday cá»§a anh nha? ðŸ’«",
      "2025-08-16": "Sinh nháº­t embe ðŸŽ‚",
      "2025-09-02": "Sinh nháº­t emm ðŸŽˆ",
      "2025-09-04": "1 thÃ¡ng yÃªu anh ðŸ’–",
      "2025-10-04": "2 thÃ¡ng gÃ²i kÃ¬a ðŸŽ‰",
      "2025-12-25": "DÃ¡ng xinhh ðŸŽ„"
    };

    // LocalStorage-backed notes (per-day)
    const NOTES_KEY = 'love_calendar_notes_v1';
    function loadNotes() {
      try { return JSON.parse(localStorage.getItem(NOTES_KEY) || '{}'); }
      catch (e) { return {}; }
    }
    function saveNotes(notes) { localStorage.setItem(NOTES_KEY, JSON.stringify(notes)); }

    // Calendar state and rendering
    let viewYear, viewMonth;
    const today = new Date();
    viewYear = today.getFullYear();
    viewMonth = today.getMonth();

    function generateCalendar(year, month) {
      const firstDay = new Date(year, month, 1).getDay();
      const lastDate = new Date(year, month + 1, 0).getDate();

      let calendar = "<table>";
      const weekdays = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
      calendar += "<tr>" + weekdays.map(d => `<th>${d}</th>`).join("") + "</tr><tr>";

      for (let i = 0; i < firstDay; i++) {
        calendar += "<td></td>";
      }

      const notes = loadNotes();

      for (let d = 1; d <= lastDate; d++) {
        const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        let classes = "";
        let tooltip = "";

        if (importantDays[dateStr]) {
          classes = "important";
          tooltip = `<div class="tooltip">${importantDays[dateStr]}</div>`;
        }

        const hasNote = notes[dateStr] && notes[dateStr].text && notes[dateStr].text.trim().length > 0;
        const noteDot = hasNote ? `<div style=\"position:absolute;right:8px;top:8px;width:8px;height:8px;border-radius:50%;background:#ffd369;box-shadow:0 0 6px rgba(255,211,105,0.9);\"></div>` : '';

        calendar += `<td class="${classes}" data-date="${dateStr}">${d}${tooltip}${noteDot}</td>`;

        if ((d + firstDay) % 7 === 0) calendar += "</tr><tr>";
      }

      calendar += "</tr></table>";
      document.getElementById("calendar").innerHTML = calendar;

      // attach click handlers to date cells for notes
      document.querySelectorAll('#calendar td[data-date]').forEach(td => {
        td.addEventListener('click', () => openNoteModal(td.dataset.date));
      });
    }

    function renderView() {
      generateCalendar(viewYear, viewMonth);
      const title = new Date(viewYear, viewMonth, 1).toLocaleString(undefined, { month: 'long', year: 'numeric' });
      document.getElementById('monthTitle').textContent = title;
    }

    // initial render
    renderView();

    // prev/next month buttons (already present in DOM)
    document.getElementById('prevMonth').addEventListener('click', () => {
      viewMonth -= 1; if (viewMonth < 0) { viewMonth = 11; viewYear -= 1; }
      renderView();
    });
    document.getElementById('nextMonth').addEventListener('click', () => {
      viewMonth += 1; if (viewMonth > 11) { viewMonth = 0; viewYear += 1; }
      renderView();
    });

    // Modal and note actions (open/save/delete)
    const modal = document.getElementById('noteModal');
    const noteDateEl = document.getElementById('noteDate');
    const noteAuthor = document.getElementById('noteAuthor');
    const noteText = document.getElementById('noteText');
    const saveBtn = document.getElementById('saveNote');
    const deleteBtn = document.getElementById('deleteNote');
    const closeBtn = document.getElementById('closeModal');

    // Author pill buttons behavior
    const authorPills = document.querySelectorAll('.author-pill');
    function setAuthorPill(author) {
      authorPills.forEach(p => {
        if (p.dataset.author === author) {
          p.style.background = '#ffd369';
          p.style.color = '#2b1b00';
          p.style.borderColor = 'transparent';
        } else {
          p.style.background = 'transparent';
          p.style.color = '#fff';
          p.style.borderColor = 'rgba(255,255,255,0.12)';
        }
      });
      // store in hidden input
      noteAuthor.value = author || '';
    }
    authorPills.forEach(p => p.addEventListener('click', () => setAuthorPill(p.dataset.author)));

    function openNoteModal(dateStr) {
      const notes = loadNotes();
      const record = notes[dateStr] || { author: '', text: '' };
      noteDateEl.textContent = new Date(dateStr).toLocaleDateString(undefined, { weekday:'long', month:'long', day:'numeric', year:'numeric' });
      setAuthorPill(record.author || 'em bÃ©');
      noteText.value = record.text || '';
      modal.style.display = 'flex';
      modal.dataset.date = dateStr;
    }

    function closeModal() { modal.style.display = 'none'; delete modal.dataset.date; }

    saveBtn.addEventListener('click', () => {
      const dateStr = modal.dataset.date; if (!dateStr) return;
      const notes = loadNotes();
      const text = noteText.value.trim();
      const author = noteAuthor.value.trim();
      if (!text) { delete notes[dateStr]; } else { notes[dateStr] = { author, text, updated: Date.now() }; }
      saveNotes(notes); closeModal(); renderView();
    });

    deleteBtn.addEventListener('click', () => {
      const dateStr = modal.dataset.date; if (!dateStr) return;
      const notes = loadNotes(); delete notes[dateStr]; saveNotes(notes); closeModal(); renderView();
    });

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

    // Gist sync removed â€” using localStorage-only notes

    // Timer logic
    function updateTimer() {
      const now = new Date();
      const diff = now - startDate;

      let seconds = Math.floor(diff / 1000);
      const minutes = Math.floor(seconds / 60);
      const hours = Math.floor(minutes / 60);
      const days = Math.floor(hours / 24);
      const months = Math.floor(days / 30.44);

      seconds %= 60;
      const displayMinutes = minutes % 60;
      const displayHours = hours % 24;
      const displayDays = days % 30.44 | 0;

      document.getElementById("timer").innerHTML =
        `Weâ€™ve been together for ${months} months, ${displayDays} days<br>` +
        `${displayHours} hours, ${displayMinutes} minutes, ${seconds} seconds ðŸ’•`;
    }

    setInterval(updateTimer, 1000);
    updateTimer();
    
    // --- Star generation & shooting stars ---
    (function() {
      const starsLayer = document.querySelector('.stars');
      const starsLayer2 = document.querySelector('.stars2');

      function createStarField(layer, count, scaleSeed=1) {
        // create a lightweight canvas-style background using many tiny divs for better positioning control
        const frag = document.createDocumentFragment();
        for (let i = 0; i < count; i++) {
          const s = document.createElement('div');
          const size = Math.random() * 2.2 * scaleSeed + 0.4;
          s.style.position = 'absolute';
          s.style.width = size + 'px';
          s.style.height = size + 'px';
          s.style.borderRadius = '50%';
          const x = Math.random() * 100;
          const y = Math.random() * 100;
          s.style.left = x + '%';
          s.style.top = y + '%';
          s.style.background = 'rgba(255,255,255,' + (0.6 + Math.random()*0.4) + ')';
          s.style.boxShadow = '0 0 ' + (Math.random()*6) + 'px rgba(255,255,255,0.6)';
          s.style.transform = 'translateZ(0)';
          s.className = 'star';
          // twinkle animation with random delay
          const dur = 2 + Math.random()*4;
          s.style.animation = `twinkle ${dur}s ${Math.random()*-6}s infinite linear`;
          frag.appendChild(s);
        }
        layer.appendChild(frag);
      }

      // generate two layers with different densities
      createStarField(starsLayer, 80, 1);
      createStarField(starsLayer2, 140, 1.2);

      // shooting stars
      const shooting = document.getElementById('shooting');
      function launchShootingStar() {
        const startX = Math.random() * 60 + 5; // percent
        const startY = Math.random() * 30 + 5; // percent
        shooting.style.left = startX + '%';
        shooting.style.top = startY + '%';
        shooting.style.opacity = '1';
        shooting.style.width = (Math.random()*2 + 1) + 'px';
        shooting.style.height = (40 + Math.random()*100) + 'px';
        const duration = 800 + Math.random()*900;
        shooting.style.animation = `shoot ${duration}ms linear forwards`;
        // clear after animation
        setTimeout(() => {
          shooting.style.opacity = '0';
          shooting.style.animation = '';
        }, duration + 100);
      }

      // occasionally launch shooting stars
      setInterval(() => {
        if (Math.random() > 0.7) launchShootingStar();
      }, 2500);
    })();
  </script>
</body>
</html>
